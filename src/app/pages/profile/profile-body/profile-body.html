<div class="container">
  <div class="row">
    <!-- Cover Image -->
    <div class="col-12">
      <div class="text-center position-relative" style="margin-top: 80px;">
        <!-- Cover Background -->
        <div class="profile-cover bg-primary"
             style="height: 200px; background: linear-gradient(to right, #04fceb, #79cddf, #260574);">
        </div>

        <!-- Centered Content -->
        <div class="position-absolute top-50 start-50 translate-middle text-white text-center"
             style="z-index: 5;">
          <!-- Profile Image with Upload -->
         <!-- Profile Image with Upload -->
<div class="position-relative d-inline-block">
  <!-- Image -->
  <img 
    [src]="profileImagePreview() || 'img/profile.jpg'" 
    alt="User Profile Picture"
    class="rounded-circle mb-2 border border-4 border-white"
    style="width: 100px; height: 100px; object-fit: cover; cursor: pointer;"
    (click)="fileInput.click()"
    title="Click to change photo">

  <!-- Camera Icon -->
  <div 
    class="position-absolute bottom-0 end-0 bg-primary rounded-circle d-flex align-items-center justify-content-center"
    style="width: 30px; height: 30px; transform: translate(25%, -25%); cursor: pointer;"
    (click)="fileInput.click()">
    <i class="fas fa-camera text-white" style="font-size: 14px;"></i>
  </div>

  <!-- Hidden File Input -->
  <input 
    #fileInput
    type="file"
    accept="image/*"
    (change)="onFileSelected($event)"
    style="display: none;">
</div>

<!-- Save/Cancel Buttons (Only if a new image is selected) -->
@if (tempImageFile()) {
  <div class="mt-2">
    <button 
      class="btn btn-success btn-sm me-2"
      [disabled]="isUploading()"
      (click)="saveProfileImage()">
      <i class="fas fa-save me-1"></i>
      {{ isUploading() ? 'Saving...' : 'Save Image' }}
    </button>
    <button 
      class="btn btn-outline-secondary btn-sm"
      (click)="cancelImageEdit()">
      Cancel
    </button>
  </div>
}

          <!-- User Info -->
          <div class="mt-2">
            <h5 class="mb-0">{{ userProfile()?.firstName }} {{ userProfile()?.lastName }}</h5>
            <p class="text-black-50 mb-0">{{ userProfile()?.email }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs Section -->
    <div class="container profile-container mt-4">
      <ul class="nav nav-tabs profile-tabs" id="profileTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="account-tab" data-bs-toggle="tab" data-bs-target="#account"
                  type="button" role="tab" aria-controls="account" aria-selected="true">
            <i class="fas fa-user-circle me-2"></i>Account
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="Bookings-tab" data-bs-toggle="tab" data-bs-target="#Bookings"
                  type="button" role="tab" aria-controls="Bookings" aria-selected="false">
            <i class="fas fa-calendar-check me-2"></i>Bookings
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="payment-tab" data-bs-toggle="tab" data-bs-target="#payment"
                  type="button" role="tab" aria-controls="payment" aria-selected="false">
            <i class="fas fa-credit-card me-2"></i>Payment Methods
          </button>
        </li>
      </ul>

      <!-- Tab Content -->
      <div class="tab-content profile-tab-content" id="profileTabContent">
        <!-- Account Tab -->
        <div class="tab-pane fade show active" id="account" role="tabpanel" aria-labelledby="account-tab">
          <div class="card profile-card mt-3">
            <div class="card-body">
              <h5 class="card-title mb-4"><i class="fas fa-cog me-2"></i>Account Settings</h5>
              <form class="profile-form">
                <div class="row">
                  <!-- First Name -->
                  <div class="col-md-6 mb-4">
                    <div class="form-field">
                      <label for="Fname" class="form-label">First Name</label>
                      <div class="input-group">
                        <input type="text" class="form-control" id="Fname"
                               [readonly]="!editFirstName()"
                               [(ngModel)]="editableProfile.firstName"
                               name="firstName"
                               [value]="userProfile()?.firstName">
                        <button type="button" class="btn btn-outline-secondary input-group-text"
                                (click)="toggleEdit('fname')">
                          <i class="fas fa-edit me-1"></i> {{ editFirstName() ? 'Save' : 'Edit' }}
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Last Name -->
                  <div class="col-md-6 mb-4">
                    <div class="form-field">
                      <label for="Lname" class="form-label">Last Name</label>
                      <div class="input-group">
                        <input type="text" class="form-control" id="Lname"
                               [readonly]="!editLastName()"
                               [(ngModel)]="editableProfile.lastName"
                               name="lastName"
                               [value]="userProfile()?.lastName">
                        <button type="button" class="btn btn-outline-secondary input-group-text"
                                (click)="toggleEdit('lname')">
                          <i class="fas fa-edit me-1"></i> {{ editLastName() ? 'Save' : 'Edit' }}
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Email -->
                  <div class="col-md-6 mb-4">
                    <div class="form-field">
                      <label for="email" class="form-label">Email</label>
                      <div class="input-group">
                        <input type="email" class="form-control" id="email"
                               [value]="userProfile()?.email" readonly>
                        <span class="input-group-text text-muted">
                          <i class="fas fa-lock"></i>
                        </span>
                      </div>
                      <small class="text-muted">Contact support to change email</small>
                    </div>
                  </div>

                  <!-- Phone -->
                  <div class="col-md-6 mb-4">
                    <div class="form-field">
                      <label for="phone" class="form-label">Phone number</label>
                      <div class="input-group">
                        <input type="text" class="form-control" id="phone"
                               [readonly]="!editPhone()"
                               [(ngModel)]="editableProfile.phone"
                               name="phone"
                               [value]="userProfile()?.phone">
                        <button type="button" class="btn btn-outline-secondary input-group-text"
                                (click)="toggleEdit('phone')">
                          <i class="fas fa-edit me-1"></i> {{ editPhone() ? 'Save' : 'Edit' }}
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Address -->
                  <div class="col-md-6 mb-4">
                    <div class="form-field">
                      <label for="address" class="form-label">Address</label>
                      <div class="input-group">
                        <input type="text" class="form-control" id="address"
                               [readonly]="!editAddress()"
                               [(ngModel)]="editableProfile.address"
                               name="address"
                               [value]="userProfile()?.address">
                        <button type="button" class="btn btn-outline-secondary input-group-text"
                                (click)="toggleEdit('address')">
                          <i class="fas fa-edit me-1"></i> {{ editAddress() ? 'Save' : 'Edit' }}
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Date of Birth -->
                  <div class="col-md-6 mb-4">
                    <div class="form-field">
                      <label for="dob" class="form-label">Date of birth</label>
                      <div class="input-group">
                        <input type="text" class="form-control" id="dob"
                               [readonly]="!editDateOfBirth()"
                               [(ngModel)]="editableProfile.dateOfBirth"
                               name="dob"
                               [value]="userProfile()?.dateOfBirth | date:'yyyy-MM-dd'">
                        <button type="button" class="btn btn-outline-secondary input-group-text"
                                (click)="toggleEdit('dateOfBirth')">
                          <i class="fas fa-edit me-1"></i> {{ editDateOfBirth() ? 'Save' : 'Edit' }}
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Bookings Tab -->
        <div class="tab-pane fade" id="Bookings" role="tabpanel" aria-labelledby="Bookings-tab">
          <app-booking-body-details></app-booking-body-details>
        </div>

        <!-- Payment Methods Tab -->
        <div class="tab-pane fade" id="payment" role="tabpanel" aria-labelledby="payment-tab">
          <div class="card profile-card mt-3">
            <div class="card-body">
              <h5 class="card-title mb-4"><i class="fas fa-credit-card me-2"></i>Payment Methods</h5>
              <div class="empty-state text-center">
                <i class="fas fa-credit-card empty-icon" style="font-size: 48px; color: #adb5bd;"></i>
                <p class="empty-text text-muted">No payment methods added.</p>
                <button class="btn btn-primary">
                  <i class="fas fa-plus me-2"></i>Add Payment Method
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>